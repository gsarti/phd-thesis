%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Packages                                                              %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage[export]{adjustbox}
\usepackage[algoruled,ruled,vlined,noend]{algorithm2e}
\usepackage[]{algorithmicx}
\usepackage{algpseudocode}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{arydshln}
\usepackage{bm}
\usepackage{bookmark}
\usepackage{booktabs}
\usepackage{calc}
\usepackage{caption}
\usepackage{changepage}
\usepackage{color}
\usepackage[T1]{fontenc}
\usepackage{fbb}
\usepackage[inline, shortlabels]{enumitem}
\usepackage{epstopdf}
\usepackage{etoolbox}
\usepackage[mathscr]{euscript}
\usepackage{fancyvrb}
\usepackage{float}
\usepackage{fontawesome}
\usepackage{footnotehyper}
\usepackage{forest}
\usepackage[margin=25mm]{geometry}
\usepackage{graphicx}
\usepackage{grffile}
\usepackage{hyperref}
\usepackage[utf8]{inputenc}
\usepackage{kantlipsum}
\usepackage[defaultsans]{lato}
\usepackage{latexsym}
\usepackage{listings}
\usepackage{lmodern}
\usepackage{longtable}
\usepackage{lscape}
\usepackage{mathtools}
\usepackage{microtype}
\usepackage{mfirstuc}
\usepackage{multicol}
\usepackage{multirow}
\usepackage{numprint}
\usepackage[super]{nth}
\usepackage{pdfpages}
\usepackage{pgffor}
\usepackage{pifont}
\usepackage{ragged2e}
\usepackage{relsize}
\usepackage{rotating}
\usepackage{siunitx}
\usepackage{soul}
\usepackage{subcaption}
\usepackage{tablefootnote}
\usepackage{tabularx}
\usepackage{tabu}
\usepackage{textcomp}
\usepackage{tikz}
\usepackage{times}
\usepackage[table]{xcolor}
\usepackage[normalem]{ulem}
\usepackage{url}
\usepackage{xstring}
\usepackage{xurl}
\usepackage{inconsolata}
\usepackage{array}
\usepackage{cleveref}
\usepackage{xspace}
\usepackage{hwemoji}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Page Setup                                                            %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\hypersetup{
    colorlinks,
    citecolor=black,
    filecolor=black,
    linkcolor=black,
    urlcolor=black
}

\linespread{1.15}
\sisetup{detect-weight=true,detect-all}
\renewcommand{\normalsize}{\fontsize{9.5pt}{12.6pt}\selectfont}
\renewcommand{\abstracttextfont}{\fontsize{9.5pt}{12.6pt}\selectfont}
\renewcommand{\footnotesize}{\fontsize{8pt}{10.6pt}\selectfont}
\renewcommand{\figurename}{\textbf{Figure}}
\renewcommand*{\partnumfont}{\Huge}
\renewcommand*{\partnamefont}{\Huge}
\renewcommand*{\parttitlefont}{\Huge\bfseries}
\renewcommand*{\printpartname}{\partnamefont\MakeUppercase\partname}
\renewcommand*{\printparttitle}[1]{\parttitlefont{#1}}
\renewcommand{\printtoctitle}[1]{\vspace{-2.5cm}\flushright\Huge\bfseries#1\vspace{-1cm}}
\renewcommand*{\cftpartfont}{\bfseries}
\renewcommand*{\cftpartpagefont}{\bfseries}
\renewcommand*{\cftchapterfont}{\bfseries}
\renewcommand*{\cftchapterpagefont}{\cftchapterfont\bfseries}
\makeatletter
\renewcommand*{\l@chapter}[2]{\l@chapapp{{#1}}{#2}{\cftchaptername}}
\renewcommand*{\l@appendix}[2]{\l@chapapp{{#1}}{#2}{\cftchaptername}}
\renewcommand{\@pnumwidth}{2em} 
\renewcommand{\@tocrmarg}{3em}
\newcounter{rqcounter}
\setcounter{rqcounter}{1}
\makeatother

\setstocksize{240mm}{170mm}
\settrimmedsize{240mm}{170mm}{*}

\setlength{\trimtop}{\stockheight}
\addtolength{\trimtop}{-\paperheight}
\setlength{\trimedge}{\stockwidth}
\setlength{\belowcaptionskip}{-10pt}
\addtolength{\trimedge}{-\paperwidth}
\settrims{0.5\trimtop}{0.5\trimedge}
\settypeblocksize{170mm}{120mm}{*}
\setlrmargins{30mm}{*}{*}
\setulmargins{35mm}{*}{*}
\checkandfixthelayout
\interfootnotelinepenalty=10000

\setsecheadstyle{\noindent\bfseries}
\setsubsecheadstyle{\secheadstyle}
\setsubsubsecheadstyle{\secheadstyle}

\addtopsmarks{ruled}{\nouppercaseheads}{}
\makeoddhead{ruled}{\rightmark}{}{\thepage}
\makeevenhead{ruled}{\thepage}{}{\leftmark}
\makeoddfoot{ruled}{}{}{}
\makeevenfoot{ruled}{}{}{}
\pagestyle{ruled}

\setcounter{tocdepth}{2}

\setlength\absleftindent{0.0in}
\setlength\absrightindent{0.0in}
\renewcommand*{\abstractname}{}
\newcommand{\absprelude}{\noindent\normalfont{\textbf{Abstract|}}\abstracttextfont}
\captionnamefont{\bfseries}
\captionstyle{\itshape}
\captiondelim{~|~}

% Inline header with/without extra space
\newcommand{\inlineheader}[1]{%
  \vspace{0.1cm}
  \noindent\textbf{#1}\quad
}
% Header without the tab
\newcommand{\inlineheadernoquad}[1]{%
  \vspace{0.1cm}
  \noindent\textbf{#1}
}

\makeatletter
% Main chapters style
\makechapterstyle{main}{
  \chapterstyle{default}
  \renewcommand*{\chapterheadstart}{\vspace*{10pt}}
  \renewcommand*{\chapnamefont}{\Huge}%\sffamily
  \renewcommand*{\printchaptername}{
          \flushright\chapnamefont\MakeUppercase\@chapapp}
  \renewcommand{\printchapternum}{\chapnumfont \thechapter \medskip \hrule}
  \renewcommand*{\chapnumfont}{\chapnamefont}
  \renewcommand*{\chaptitlefont}{\bfseries\Huge}%\sffamily
  \renewcommand*{\printchaptertitle}[1]{
          \flushright
          \chaptitlefont{##1}
          %\bigskip\bigskip
  }
}
\chapterstyle{main}
\makeatother

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Quarto Template Defaults                                              %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
\setlength{\emergencystretch}{3em} % prevent overfull lines

% Make \paragraph and \subparagraph free-standing
\makeatletter
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}{
    \@ifstar
      \xxxParagraphStar
      \xxxParagraphNoStar
  }
  \newcommand{\xxxParagraphStar}[1]{\oldparagraph*{#1}\mbox{}}
  \newcommand{\xxxParagraphNoStar}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}{
    \@ifstar
      \xxxSubParagraphStar
      \xxxSubParagraphNoStar
  }
  \newcommand{\xxxSubParagraphStar}[1]{\oldsubparagraph*{#1}\mbox{}}
  \newcommand{\xxxSubParagraphNoStar}[1]{\oldsubparagraph{#1}\mbox{}}
\fi
\makeatother


\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}
}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother

\makesavenoteenv{longtable}

\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother

% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
% definitions for citeproc citations
\NewDocumentCommand\citeproctext{}{}
\NewDocumentCommand\citeproc{mm}{%
  \begingroup\def\citeproctext{#2}\cite{#1}\endgroup}
\makeatletter
 % allow citations to break across lines
 \let\@cite@ofmt\@firstofone
 % avoid brackets around text for \cite:
 \def\@biblabel#1{}
 \def\@cite#1#2{{#1\if@tempswa , #2\fi}}
\makeatother
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}

\newenvironment{CSLReferences}[2] % #1 hanging-indent, #2 entry-spacing
 {\begin{list}{}{%
  \setlength{\itemindent}{0pt}
  \setlength{\leftmargin}{0pt}
  \setlength{\parsep}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1
   \setlength{\leftmargin}{\cslhangindent}
   \setlength{\itemindent}{-1\cslhangindent}
  \fi
  % set entry spacing
  \setlength{\itemsep}{#2\baselineskip}}}
 {\end{list}}
\usepackage{calc}
\newcommand{\CSLBlock}[1]{\hfill\break\parbox[t]{\linewidth}{\strut\ignorespaces#1\strut}}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{\strut#1\strut}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{\strut#1\strut}}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}

\makeatletter
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Contents}
\else
  \newcommand\contentsname{Contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{Figures}
\else
  \newcommand\listfigurename{Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{Tables}
\else
  \newcommand\listtablename{Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\makeatother